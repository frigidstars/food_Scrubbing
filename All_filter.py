import sign_list
import re

"""-----------------------------------------------------------------------------

é€™ç¨‹å¼è² è²¬åšé£Ÿç‰©åç¨±ã€é£Ÿæåç¨±çš„æ–‡å­—è™•ç†ã€‚

è‡ªè¨‚å¥—ä»¶ï¼š
    sign_list
        è¼¸å‡ºä¸€ä»½å°ˆç”¨æ¨™é»ç¬¦è™Ÿæ¸…å–®
            >>> stripsign()
            >>> stripsign_origin():

â€» åœ¨å„å€‹éæ¿¾å™¨ç•¶ä¸­å¸¸æœ‰å»é™¤é¦–å°¾ç©ºç™½çš„ç‹€æ³ï¼Œåšæ³•ä¸Šå¯èƒ½æœ‰é»å¤šé¤˜ï¼Œç›®çš„åœ¨æ–¼ç¢ºä¿é¦–å°¾ç©ºç™½éƒ¨åˆ†å®Œå…¨æ¶ˆå¤±ã€‚
   æœ‰å¯èƒ½ç™¼ç”Ÿå› ç‚ºä¸Šä¸€å€‹éšæ®µè™•ç†æ™‚çš„è©åŒ¯æœ¬èº«å­—å…ƒé–“å…·æœ‰ç©ºç™½ï¼Œå†é™¤å»å¤šé¤˜å­—å…ƒä»¥å¾Œï¼ŒåŸæœ¬å€é–“å…§çš„ç©ºç™½å°±æœƒè®Šæˆé¦–å°¾çš„ç©ºç™½ã€‚
   æœ‰æ™‚å¿…é ˆä¿ç•™å­—å…ƒé–“çš„ç©ºç™½ï¼Œæ‰€ä»¥ä¹Ÿä¸èƒ½å…¼å­—å…ƒå…§æ‰€æœ‰ç©ºç™½ä¸€æ¬¡å»é™¤ï¼Œæ•…ç”¨æ¯”è¼ƒç¹ç‘£çš„æ–¹å¼ä¾†åšè™•ç†ã€‚ 
   å…¶ä»–ç›¸é—œçš„éæ¿¾æ‰‹æ®µï¼Œè¢«ä¸æ–·é‡è¤‡ä½¿ç”¨çš„ç†ç”±ä¹ŸåŒå‰›å‰›èªªæ˜çš„æƒ…æ³ã€‚
   
   åŸå§‹ç‹€æ³ï¼š
        >>> {A.(Japan) å¯Œå£«ï¼Œè˜‹æœ (3æœˆç”¢ ğŸ )  } 
   éæ¿¾çµæœï¼š     
        >>> è˜‹æœ  
                        
-----------------------------------------------------------------------------"""

## ä¸»è¦çš„æ¸…æ´— function æ¥æ”¶åˆ°çš„è³‡æ–™å¾é€™é–‹å§‹
def filter_dept(row_food):
    clean_decorations1 = first_filter(row_food)             # å°‡ "åŸå§‹_é£Ÿæåç¨±" å…ˆå¼•å…¥ç¬¬ä¸€å±¤éæ¿¾å™¨
    clean_decorations2 = second_filter(clean_decorations1)  # å°‡ç¬¬ä¸€å±¤éæ¿¾å™¨çµæœå¼•å…¥ç¬¬äºŒå±¤éæ¿¾å™¨
    return clean_decorations2                               # è¼¸å‡ºæœ€çµ‚çµæœ

## ç¬¬ä¸€å±¤éæ¿¾å™¨
def first_filter(sec_item):
    # éšæ®µ 1ï¼šå°‡å¼•å…¥é€²ä¾†çš„è©å½™åšä»¥ä¸‹è™•ç†ï¼š1.å»é™¤é¦–å°¾ç©ºç™½ 2.å‘ˆ1ï¼Œå»é™¤å»é™¤é¦–å°¾ç‰¹æ®Šç¬¦è™Ÿ 3.å‘ˆ2ï¼Œå†å»é™¤å‰å¾Œç©ºç™½
    newsec_item = sec_item.strip(" ").strip(sign_list.stripsign()).strip(" ")

    # éšæ®µ 2ï¼šå‘ˆä¸Šçµæœï¼Œå»é™¤è©å½™ä¸­åŒ…å«ä»¥ä¸‹ "æ¡†å°å½¢å¼ä¸”æ¡†å°ä¸­æœ‰ä»»ä½•å­—å…ƒ" çš„ "å­—å…ƒçµ„"
    newsec_item2 = re.sub(r"[(ã€ï¼ˆ{[ã€Šã€Œï¹ã€ˆã€”<].*[)ã€‘ï¼‰}\]ã€‹ã€ï¹ã€‰ã€•>]", "", newsec_item)

    # åˆ¤æ–·ä¸Šä¸€éšæ®µä¸­çš„è™•ç†ç‹€æ³ï¼Œæ˜¯å¦æŠŠè©å½™å®Œå…¨ç§»é™¤
    if newsec_item2 != "":      # è©å½™ä¸¦é "" ç‹€æ³
        # éšæ®µ 3-1ï¼šå‘ˆ éšæ®µ2 çµæœï¼Œåšä»¥ä¸‹è™•ç†ï¼š1.å»é™¤è©å½™ç•¶ä¸­ "è‹±æ–‡å½¢å¼ä¸”å¾Œé¢åŒ…å«å€éš”ç¬¦è™Ÿ" çš„ "å­—å…ƒçµ„" 2.å‘ˆ1ï¼Œå»é™¤å‰å¾Œç©ºç™½ 3.å‘ˆ2ï¼Œå»é™¤å»é™¤é¦–å°¾ç‰¹æ®Šç¬¦è™Ÿ 4.å‘ˆ3ï¼Œå†å»é™¤å‰å¾Œç©ºç™½
        newsec_item3 = re.sub(r"[a-zA-Zï¼¡-ï¼º][-:ï¼š./ )]", "", newsec_item2).strip(" ").strip(sign_list.stripsign()).strip(" ")
        return newsec_item3
    else:                       # è©åŒ¯å›  éšæ®µ 2 æˆç‚º "" ç‹€æ³
        # éšæ®µ 3-2ï¼šå‘ˆ éšæ®µ1 çµæœï¼Œåšä»¥ä¸‹è™•ç†ï¼š1.å»é™¤è©å½™ç•¶ä¸­ "è‹±æ–‡å½¢å¼ä¸”å¾Œé¢åŒ…å«å€éš”ç¬¦è™Ÿ" çš„ "å­—å…ƒçµ„" 2.å‘ˆ1ï¼Œå»é™¤å‰å¾Œç©ºç™½ 3.å‘ˆ2ï¼Œå»é™¤å»é™¤é¦–å°¾ç‰¹æ®Šç¬¦è™Ÿ 4.å‘ˆ3ï¼Œå†å»é™¤å‰å¾Œç©ºç™½
        newfood_item3 = re.sub(r"[a-zA-Zï¼¡-ï¼º][-:ï¼š./ )]", "", newsec_item).strip(" ").strip(sign_list.stripsign()).strip(" ")
        return newfood_item3

## ç¬¬äºŒå±¤éæ¿¾å™¨
def second_filter(trd_item):
    # éšæ®µ 1ï¼šå°‡å¼•å…¥é€²ä¾†çš„ç¬¬ä¸€å±¤éæ¿¾å¾Œçš„è³‡æ–™åšä»¥ä¸‹è™•ç†ï¼š1.å»é™¤é¦–å°¾ç©ºç™½ 2.å»é™¤é¦–å°¾æœ‰ä»¥ä¸‹ç¾…åˆ—çš„ç¬¦è™Ÿ
    newtrd_item = trd_item.strip(" ").strip("(ã€ï¼ˆ{[ã€Šã€Œï¹ã€ˆã€”<)ã€‘ï¼‰}]ã€‹ã€ï¹ã€‰ã€•>#,ï¼Œã€.:=â€»")
    # åˆ¤æ–·å¼•å…¥é€²ä¾†çš„ç¬¬ä¸€å±¤éæ¿¾å¾Œçš„è³‡æ–™æ˜¯å¦å…·æœ‰ XOé†¬ é€™è©åŒ¯
    if "XOé†¬" not in trd_item:   # è©åŒ¯ä¸­ä¸å…·æœ‰ XOé†¬
        # éšæ®µ 2-1ï¼šå‘ˆ éšæ®µ 1 çµæœï¼Œåšä»¥ä¸‹è™•ç†ï¼š1.å»é™¤è©å½™ç•¶ä¸­æ‰€æœ‰éä¸­æ–‡å­—çš„å­—å…ƒ
        newtrd_item2 = re.sub(r"[^\u4e00-\u9fa5]", "", newtrd_item)
        return newtrd_item2
    else:                        # è©åŒ¯ä¸­å…·æœ‰ "XOé†¬"
        # ç„¡è«–è©æœƒæœ‰ä»€éº¼å­—å…ƒï¼Œå«æœ‰ XOé†¬ çš„è©åŒ¯ç›´æ¥è½‰æ›æˆ "XOé†¬"
        newtrd_item2 = "XOé†¬"
        return newtrd_item2


## é£Ÿè­œåç¨±éæ¿¾å™¨
def name_filter(recipe_name):
    # éšæ®µ 1ï¼šå°‡å¼•å…¥é€²ä¾†çš„è©åŒ¯åšä»¥ä¸‹è™•ç†ï¼š1.å»é™¤è©å½™ç•¶ä¸­ 2.å»é™¤é¦–å°¾ç©ºç™½ 3.å»é™¤ tab ç©ºæ ¼å‹æ…‹å­—å…ƒ 4. å»é™¤æ›è¡Œå‹æ…‹å­—å…ƒ
    c_name = re.sub(r"[\'\"]", "", recipe_name).strip().replace("\t", " ").replace("\n", "")

    # éšæ®µ 2ï¼šå‘ˆ éšæ®µ1 çµæœï¼Œå»é™¤è©å½™ç•¶ä¸­æœ‰è‡ªå®šç¾©çš„ç‰¹æ®Šç¬¦è™Ÿè¡¨ä¸­å‡ºç¾çš„å­—å…ƒ
    c_name2 = re.sub(r"[{}]".format(sign_list.stripsign_origin()), "", c_name)

    # éšæ®µ 3ï¼šå‘ˆ éšæ®µ2 çµæœï¼Œåšä»¥ä¸‹è™•ç†ï¼š1.å»é™¤é™¤äº†ä¸­æ–‡ã€è‹±æ–‡åŠæŒ‡å®šçš„æ¡†å°ç¬¦è™Ÿä»¥å¤–çš„å­—å…ƒ 2.å»é™¤é¦–å°¾ç©ºç™½
    clean_name = re.sub(r"[^\u4e00-\u9fa5()\[\]{}\-a-zA-Z0-9]", " ", c_name2).strip()
    return clean_name


















